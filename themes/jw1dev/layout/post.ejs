<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title><%- page.title + ' - ' + config.title %></title>
  <%- partial('partial/meta') %>
  <% if(page.style){ %>
    <%- page.style %>
  <% } %>
  <script>
    // Fix iOS Audio Context by Blake Kus https://gist.github.com/kus/3f01d60569eeadefe3a1
    // MIT license
    (function() {
      window.AudioContext = window.AudioContext || window.webkitAudioContext;
      if (window.AudioContext) {
        window.audioContext = new window.AudioContext();
      }
      var fixAudioContext = function (e) {
        if (window.audioContext) {
          // Create empty buffer
          var buffer = window.audioContext.createBuffer(1, 1, 22050);
          var source = window.audioContext.createBufferSource();
          source.buffer = buffer;
          // Connect to output (speakers)
          source.connect(window.audioContext.destination);
          // Play sound
          if (source.start) {
            source.start(0);
          } else if (source.play) {
            source.play(0);
          } else if (source.noteOn) {
            source.noteOn(0);
          }
        }
        // Remove events
        document.removeEventListener('touchstart', fixAudioContext);
        document.removeEventListener('touchend', fixAudioContext);
      };
      // iOS 6-8
      document.addEventListener('touchstart', fixAudioContext);
      // iOS 9
      document.addEventListener('touchend', fixAudioContext);
    })();
  </script>
</head>
<body>
  <div id="app">
    <header>
      <div class="logo" style="margin-bottom: 30px">
        <a href="<%- config.url %>">
          <img src="/images/logo-black.png" class="dark" alt="<%- config.title %>">
          <img src="/images/logo.png" class="light" alt="<%- config.title %>">
        </a>
      </div>
      <h1>
        <%- page.title %>
      </h1>
    </header>
    <main>
      <% if(page.__post){ %>
        <div class="page-info">
          <%- moment(page.date).format('YYYY-MM-DD') %> /
          <% if(page.deprecated) { %>
            <span class="deprecated">Deprecated</span> /
          <% } %>
          <% if(page.tags) { %>
            <% page.tags.forEach((tag, index) => {%>
              <%- tag.name %>
              <% if(index !== page.tags.length - 1) { %>
                /
              <% } %>
            <% }) %>
          <% } %>
        </div>
      <% } %>
      <div class="page-content">
        <%- page.content %>
      </div>
      <% if(!page.no_donation) { %>
        <%- partial('partial/comment') %>
      <% } %>
      <% if(!is_page()){ %>
        <%- partial('partial/original') %>
      <% } %>
      
    </main>
    <%- partial('partial/footer') %>
    <%- partial('partial/analytics') %>
  </div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js" integrity="sha512-odNmoc1XJy5x1TMVMdC7EMs3IVdItLPlCeL5vSUPN2llYKMJ2eByTTAIiiuqLg+GdNr9hF6z81p27DArRFKT7A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.7.8/vue.min.js"
          integrity="sha512-FBUSVbYJGylZSdYsKcPzD8eeP7xHN3ke9AeIZhmGWigvqdTibWEPGGOv0ppwvawuJswJ6/vQIfsq6q/7dAAx9g=="
          crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="/js/post.js"></script>
  <script src="/js/g-analytics.js"></script>
</body>
</html>