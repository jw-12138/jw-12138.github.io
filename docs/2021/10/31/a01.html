<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>究竟什么样的代码才能被称为专业？ - 一个球的博客</title>
    <link rel="shortcut icon" href="/favicon.png" type="image/x-icon" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="/assets/css/normalize.css" />
<link rel="stylesheet" href="/assets/css/index.min.css" />
<link rel="stylesheet" href="/assets/css/rouge-syntax.css">
<meta name="keywords" content="一个球,前端,网页,web,技术,css3,html5,frontend,front-end,ableton,live,music,production,编曲,音乐制作,制作人,摄影,编码习惯" id="keywords" />
<meta name="description" content="Front-end Developer / Music Producer" />
    
  </head>
  <body>
    <div id="app">
      <div class="app-wrap">
        <header>
  <div class="logo">
    <a href="/" title="Click here to navigate homepage" id="header">
      <div class="img">
        <img src="/assets/img/logo-black.png" alt="logo" class="dark" />
        <img src="/assets/img/logo.png" alt="logo" class="light" />
      </div>
    </a>
  </div>
  <div class="slogan" ref="slogan">
    Front-end Developer / Music Producer
  </div>
  <div class="page-small-menu" v-if="page_small">
    <ul>
      
      <li>
        <a href="/about/">About Me</a>
      </li>
      
      <li>
        <a href="/atom.xml" target="_blank">RSS</a>
      </li>
    </ul>
  </div>
</header>
        <div class="page-wrap">
          <section class="pages" style="padding-top: 20px">
            <div class="page">
              <div class="wrap">
                <h2 class="page-header">究竟什么样的代码才能被称为专业？</h2>
                 
                <div class="page-date">
                  <span>👨‍💻: 2021-10-31</span>
                  
                </div>
                
                <div class="page-content"><p>最近在油管看了一个视频，名字叫 <a href="https://www.youtube.com/watch?v=g2nMKzhkvxw">Junior Vs Senior Code - How To Write Better Code</a>，可以说标题立刻勾起了我的好奇心，我真的很好奇一个初级程序员和一个高级程序员在面对同样业务逻辑的时候，写出的代码为什么会天差地别。然而看完该视频后，我对于作者对高级程序员的看法有些不同的见解。</p>
<p>就JavaScript而言，在作者的观点中，一个pro应该：</p>
<ul>
<li>所有的代码都必须尽可能的简洁干净</li>
<li>考虑所有可能出现的错误，并在方法中处理掉</li>
</ul>
<p>然而事实上，我们真的需要这样写代码吗？</p>
<p>先来看这样一段代码：</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[].</span><span class="nx">forEach</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">$$</span><span class="p">(</span><span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">outline</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1px solid #</span><span class="dl">"</span> <span class="o">+</span> <span class="p">(</span><span class="o">~~</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">24</span><span class="p">))).</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">)})</span>
</code></pre></div></div>
<p>这是Addy Osmani在Github Gist上面发布一段用来调试CSS的代码，如果你把它复制进浏览器的Devtools控制台并按下回车执行它，它会给每一个元素都加上不同颜色的outline。抛开代码中用到的技术不谈，单论这样一行代码，你觉得它专业吗？我的答案是：</p>
<p>It depends.</p>
<p>如果你是参加一个编程比赛，主题是用最少的代码让浏览器上每个元素都显示出不同颜色的outline，那这样一行代码可以说是非常专业了，很可能你就是冠军了。但是如果这是一个团队协作的项目，你给出了这样的代码，code reviewer反而可能会骂死你。为什么？因为你的代码可读性几乎为零，除了炫技，一无是处。作为团队中的一员，保证其他成员能以最低成本看懂你的代码才应该是最高优先级的。</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * @description put outline on every single element in the document
 */</span>
<span class="kd">function</span> <span class="nx">outlineEverything</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">everyElements</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">)</span>
  <span class="nx">everyElements</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">el</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">randomColor</span> <span class="o">=</span> <span class="nx">makeRandomColor</span><span class="p">()</span>
    <span class="nx">el</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">outline</span> <span class="o">=</span> <span class="s2">`1px solid #</span><span class="p">${</span><span class="nx">randomColor</span><span class="p">}</span><span class="s2">`</span>
  <span class="p">})</span>
<span class="p">}</span>
<span class="cm">/**
 * @description get a random hex color value `rrggbb` without the `#`
 * @returns {string} 
 */</span>
<span class="kd">function</span> <span class="nx">makeRandomColor</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// get a random number between 0 - (256 * 256 * 256)</span>
  <span class="kd">let</span> <span class="nx">_r</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">256</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">*</span> <span class="mi">256</span><span class="p">))</span>

  <span class="c1">// return number in hexadecimal</span>
  <span class="k">return</span> <span class="nx">_r</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">outlineEverything</span><span class="p">()</span>
</code></pre></div></div>
<p>再来看看现在的代码，在保证同样功能性的前提下，大幅提高了代码的可读性，这才是我们在开发阶段需要的代码啊！</p>
<p>可能有人会说性能问题，那如果我告诉你后者的性能只比前者差不到5%你会怎么想？</p>
<p><img src="/p_assets/202110/a01/image-20211031235747406.png" alt="image-20211031235747406" /></p>
<p>这5%的性能损失可能会换回同事的不杀之恩也不一定呢？而且很多时候，<strong>并不是代码少，程序就能跑得快的</strong>，关于这一点以后可以专门写一篇博客来说明一下。</p>
<blockquote>
<p>—— 在开发阶段，你越是压缩代码的写法，在维护阶段它越有可能被删掉。</p>
</blockquote>
<hr />
<p>下面再来说说，自己的代码中究竟应不应该处理所有可能出现的错误。来看看这样一段代码：</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">itemData</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">price</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
  <span class="na">quantity</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="na">discount</span><span class="p">:</span> <span class="mf">0.05</span> <span class="c1">// rate in 0-1 scale</span>
<span class="p">}</span>

<span class="cm">/**
 * @description get items total amount of money with discount applied
 * @param {object} item
 * @param {number} item.price
 * @param {number} item.discount
 * @param {number} item.quantity
 * @returns {string} total money
 */</span>
<span class="kd">function</span> <span class="nx">getTotal</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">_total</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">quantity</span> <span class="o">*</span> <span class="nx">item</span><span class="p">.</span><span class="nx">price</span>
  <span class="kd">let</span> <span class="nx">_discountAppliedTotal</span> <span class="o">=</span> <span class="nx">_total</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">item</span><span class="p">.</span><span class="nx">discount</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">_discountAppliedTotal</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">getTotal</span><span class="p">(</span><span class="nx">itemData</span><span class="p">))</span>
</code></pre></div></div>
<p>如果执行正确的话，那么控制台应该输出<code>28.50</code>，因为一共3件商品，商品单价为10，再加上5%的折扣，那总价确实是28.50，按照现实中的逻辑，这样的代码不管是从可读性和健壮性来说其实已经非常好了。但是以视频作者的意思，任何可能出错的地方都要加以处理，也就是说，我们需要考虑商品数量、折扣和单价都有可能会出现<code>null</code>或者<code>undefined</code>值，如此缜密的心思当然是值得鼓励的，但是从实际开发角度看去这会让原本clean的代码变得not that clean：</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">getTotal</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">discount</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">discount</span> <span class="o">===</span> <span class="kc">null</span><span class="p">){</span>
    <span class="k">return</span> <span class="mi">0</span>
  <span class="p">}</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">price</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">price</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">price</span> <span class="o">===</span> <span class="mi">0</span><span class="p">){</span>
    <span class="k">return</span> <span class="mi">0</span>
  <span class="p">}</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">quantity</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">quantity</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">quantity</span> <span class="o">===</span> <span class="mi">0</span><span class="p">){</span>
    <span class="k">return</span> <span class="mi">0</span>
  <span class="p">}</span>
  <span class="kd">let</span> <span class="nx">_total</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">quantity</span> <span class="o">*</span> <span class="nx">item</span><span class="p">.</span><span class="nx">price</span>
  <span class="kd">let</span> <span class="nx">_discountAppliedTotal</span> <span class="o">=</span> <span class="nx">_total</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">item</span><span class="p">.</span><span class="nx">discount</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">_discountAppliedTotal</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>
<p><code>getTotal</code>方法的代码瞬间比之前多了一倍，而且这么写下来真的有意义吗？如果后端真的返回给你的数值是负数或者为<code>null</code>，这难道不应该是后端的问题吗？为什么要在前端进行静默处理？是觉得debug难度还不够大吗？</p>
<blockquote>
<p>—— 任何代码的出现都应当以实际业务逻辑为参考系，否则毫无意义。</p>
</blockquote>
<hr />
<p>总结：脚踏实地，事无巨细，这样写出来的代码，才是专业的代码。</p>
</div>
                <div class="page-original">
                  <a class="license" rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width: 0" src="/assets/img/cc.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
                </div>
              </div>
            </div>
          </section>
          <section class="aside" v-if="!page_small" aria-label="aside">
            <ul>
              
              <li>
                <a href="/about/" title="About Me">👦 About Me</a>
              </li>
              
              <li>
                <a href="/atom.xml" title="RSS feeds" target="_blank">🚩 RSS</a>
              </li>
            </ul>
          </section>
        </div>
        <footer>© <span class="copy_right_year">2018 - 2021</span><a href="/" class="footer-link">一个球的博客</a>code with ❤</footer>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.min.js"></script>
    
    <script src="/assets/js/post.js"></script>
  </body>
</html>
