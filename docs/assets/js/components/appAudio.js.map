{"version":3,"sources":["../../ts/components/appAudio.js"],"names":["window","appAudio","props","src","default","label","hasloop","template","computed","mounted","_this","a","$refs","audio_ele","addEventListener","canplayFun","instance_id","getTimeStamp","document","range_count","methods","audio","duration","percent","calcPercentage","hasWave","ontimeupdate","adjust_progress_ready","currentTime","onended","looping","play","playing","onpause","onplay","url_arr","split","url","axios","method","then","res","status","wave_img","wave_img_src","catch","error","console","log","handleClick","e","preventDefault","ct","du","stopAudio","toggle_loop","onRangeChange","range_input","getElementById","value","onRangeInput","rangeChangeDown","data","timeOffset","watch","pause"],"mappings":"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","sourcesContent":["window.appAudio = {\r\n  props: {\r\n    src: {\r\n      default: ''\r\n    },\r\n    label: {\r\n      default: ''\r\n    },\r\n    hasloop: {\r\n      default: false\r\n    }\r\n  },\r\n  template: `<div class=\"app-audio-wrap\">\r\n  <audio :src=\"src\" ref=\"audio_ele\" preload=\"metadata\"></audio>\r\n  <div class=\"name\">\r\n    {{ label }}\r\n  </div>\r\n  <div class=\"time\" title=\"This is the timing panel\">\r\n    <span class=\"b\" :title=\"'Currently on the ' + parseInt(currentTime) + ' second'\">{{ sec2time(currentTime) }}</span> <em aria-hidden=\"true\">/</em> <span :title=\"'This track has ' + parseInt(duration) + ' seconds'\">{{ sec2time(duration) }}</span>\r\n  </div>\r\n  <div class=\"control\" title=\"This is the control panel\">\r\n    <div class=\"btn-grp\">\r\n      <button class=\"btn\" @click=\"handleClick\" :title=\"!playing ? 'Paused, click to start playing audio' : 'started, click to pause audio'\">\r\n        <svg v-if=\"!playing\" xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M10.8 15.9l4.67-3.5c.27-.2.27-.6 0-.8L10.8 8.1c-.33-.25-.8-.01-.8.4v7c0 .41.47.65.8.4zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\" /></svg>\r\n        <svg v-if=\"playing\" xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M10 16c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1s-1 .45-1 1v6c0 .55.45 1 1 1zm2-14C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm2-4c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1s-1 .45-1 1v6c0 .55.45 1 1 1z\" /></svg>\r\n      </button>\r\n      <button class=\"btn\" @click=\"stopAudio\" title=\"click to stop playing audio\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" enable-background=\"new 0 0 24 24\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\r\n          <g>\r\n            <rect fill=\"none\" height=\"24\" width=\"24\" />\r\n            <rect fill=\"none\" height=\"24\" width=\"24\" />\r\n          </g>\r\n          <g><path d=\"M9,16h6c0.55,0,1-0.45,1-1V9c0-0.55-0.45-1-1-1H9C8.45,8,8,8.45,8,9v6 C8,15.55,8.45,16,9,16z M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2L12,2z\" fill-rule=\"evenodd\" /></g>\r\n        </svg>\r\n      </button>\r\n      <button v-if=\"hasloop\" class=\"btn\" :title=\"!looping ? 'Put audio on loop' : 'Currently on loop, click again to disable'\" @click=\"toggle_loop\" :class=\"{ on: looping }\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M12 4V2.21c0-.45-.54-.67-.85-.35l-2.8 2.79c-.2.2-.2.51 0 .71l2.79 2.79c.32.31.86.09.86-.36V6c3.31 0 6 2.69 6 6 0 .79-.15 1.56-.44 2.25-.15.36-.04.77.23 1.04.51.51 1.37.33 1.64-.34.37-.91.57-1.91.57-2.95 0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-.79.15-1.56.44-2.25.15-.36.04-.77-.23-1.04-.51-.51-1.37-.33-1.64.34C4.2 9.96 4 10.96 4 12c0 4.42 3.58 8 8 8v1.79c0 .45.54.67.85.35l2.79-2.79c.2-.2.2-.51 0-.71l-2.79-2.79c-.31-.31-.85-.09-.85.36V18z\" /></svg>\r\n      </button>\r\n    </div>\r\n  </div>\r\n  <input type=\"range\" min=\"0\" max=\"100\" v-model=\"percent\" :id=\"instance_id\" @change=\"onRangeChange\" @input=\"onRangeInput\" title=\"Progress bar\" @mousedown=\"rangeChangeDown\" @touchstart=\"rangeChangeDown\" :style=\"{ 'background-image': 'url(' + wave_img_src + ')' }\" />\r\n</div>`,\r\n  computed: {},\r\n  mounted: function () {\r\n    let _this = this\r\n    let a = this.$refs.audio_ele\r\n    a.addEventListener('loadedmetadata', function () {\r\n      _this.canplayFun(a)\r\n    })\r\n    _this.instance_id = getTimeStamp()\r\n    document.addEventListener('mouseup', function () {\r\n      _this.range_count = 0\r\n    })\r\n    document.addEventListener('touchend', function () {\r\n      _this.range_count = 0\r\n    })\r\n  },\r\n  methods: {\r\n    canplayFun: function (a) {\r\n      let _this = this\r\n      _this.audio = a\r\n      _this.duration = _this.audio.duration\r\n      _this.percent = _this.calcPercentage()\r\n      _this.hasWave()\r\n      _this.audio.ontimeupdate = function () {\r\n        if (!_this.adjust_progress_ready && _this.range_count == 0) {\r\n          _this.percent = _this.calcPercentage()\r\n          _this.currentTime = _this.audio.currentTime\r\n        }\r\n      }\r\n      _this.audio.onended = function () {\r\n        _this.percent = 0\r\n        _this.audio.currentTime = 0\r\n        _this.currentTime = 0\r\n        if (_this.looping) {\r\n          _this.audio.play()\r\n          return false\r\n        }\r\n        _this.playing = false\r\n      }\r\n\r\n      _this.audio.onpause = function () {\r\n        _this.playing = false\r\n      }\r\n\r\n      _this.audio.onplay = function () {\r\n        _this.playing = true\r\n      }\r\n    },\r\n    hasWave: function () {\r\n      let _this = this\r\n      let url_arr = _this.src.split('.')\r\n      let url = url_arr[0] + '.png'\r\n      axios({\r\n        method: 'get',\r\n        url: url\r\n      })\r\n        .then(function (res) {\r\n          if (res.status == 200) {\r\n            _this.wave_img = true\r\n            _this.wave_img_src = url\r\n          }\r\n        })\r\n        .catch(function (error) {\r\n          console.log(error)\r\n        })\r\n    },\r\n    handleClick: function (e) {\r\n      e.preventDefault()\r\n      let _this = this\r\n      _this.playing = !_this.playing\r\n    },\r\n    calcPercentage: function () {\r\n      let _this = this\r\n      let ct = _this.audio.currentTime\r\n      let du = _this.audio.duration\r\n      return (ct / du) * 100\r\n    },\r\n    stopAudio: function (e) {\r\n      e.preventDefault()\r\n      let _this = this\r\n      _this.audio.currentTime = 0\r\n      _this.currentTime = _this.audio.currentTime\r\n      _this.playing = false\r\n      _this.looping = false\r\n    },\r\n    toggle_loop: function (e) {\r\n      e.preventDefault()\r\n      this.looping = !this.looping\r\n    },\r\n    onRangeChange: function () {\r\n      let _this = this\r\n      let range_input = document.getElementById(_this.instance_id)\r\n      _this.adjust_progress_ready = false\r\n      _this.percent = range_input.value\r\n      _this.audio.currentTime = (_this.percent / 100) * _this.audio.duration\r\n      _this.currentTime = _this.audio.currentTime\r\n      _this.range_count = 0\r\n    },\r\n    onRangeInput: function () {\r\n      let _this = this\r\n      let range_input = document.getElementById(_this.instance_id)\r\n      _this.percent = range_input.value\r\n      _this.currentTime = (_this.percent / 100) * _this.audio.duration\r\n      _this.adjust_progress_ready = false\r\n      _this.range_count++\r\n    },\r\n    rangeChangeDown: function () {\r\n      let _this = this\r\n      let range_input = document.getElementById(_this.instance_id)\r\n      _this.percent = range_input.value\r\n      _this.audio.currentTime = (_this.percent / 100) * _this.audio.duration\r\n      _this.currentTime = _this.audio.currentTime\r\n      _this.adjust_progress_ready = true\r\n    }\r\n  },\r\n  data: function () {\r\n    return {\r\n      playing: false,\r\n      percent: 0,\r\n      audio: null,\r\n      adjust_progress_ready: false,\r\n      duration: 0,\r\n      currentTime: 0,\r\n      wave_img: false,\r\n      wave_img_src: '',\r\n      timeOffset: 0.25,\r\n      instance_id: null,\r\n      looping: false,\r\n      range_count: 0\r\n    }\r\n  },\r\n  watch: {\r\n    playing: function (e) {\r\n      let _this = this\r\n      if (e) {\r\n        _this.audio.play()\r\n      } else {\r\n        _this.audio.pause()\r\n      }\r\n    }\r\n  }\r\n}\r\n"],"file":"appAudio.js"}